{{ $cover := false }}
{{ $defaultCover := false }}
{{- $autoCover := default $.Site.Params.autoCover false }}

{{- if index .Params "cover" -}}
  {{- if .Resources.GetMatch .Params.Cover }}
    {{ with .Resources.GetMatch .Params.Cover }}
      {{ if gt .Width 1440 }}
        {{ $cover = (.Resize "1440x jpeg q100").RelPermalink }}
      {{ else }}
        {{- $cover = .RelPermalink -}}
      {{ end }}
    {{ end }}
  {{- else -}}
    {{- $cover = absURL .Params.Cover -}}
  {{- end -}}
{{- else if $.Site.Params.AutoCover -}}
  {{- if (not .Params.Cover) -}}
    {{- if .Resources.GetMatch "cover.*" -}}
      {{- $cover = (.Resources.GetMatch "cover.*").RelPermalink -}}
    {{- end -}}
  {{- end -}}
{{- end -}}

{{ if (not $cover) }}
    {{ $defaultCover = resources.Get "img/bg/light-grey-terrazzo.webp" }}
    
{{ end }}

<div class="hero {{ if $cover }}is-halfheight has-background{{ else }}is-small has-background-primary-light{{ end }}" {{ if $defaultCover }}style="background-image: url({{ $defaultCover.RelPermalink }}); background-blend-mode: multiply;"{{ end }}>
    {{ if $cover }}
    <img src="{{ $cover }}" class="hero-background" style="filter: brightness({{ .Params.Brightness | default "70%" }});" alt="{{ .Title | plainify | default " " }}" title="{{ .Params.CoverCredit |plainify|default "Cover Image" }}" />
    {{ end }}
    <div class="hero-body">
        <div class="container">
            <h3 class="title is-3 has-text-weight-bold {{ if $cover }}has-text-white has-text-centered{{ end }}">{{ .Title | markdownify }}</h2>
        </div>
    </div>
</div>
